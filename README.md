Сервис для выдачи юзерам карточек

В системе существует конфигурация альбома с карточками. Альбом состоит из сетов. Сеты из карточек.

Пример:

Альбом "Животный мир"
- Сет "Птицы"
  - Карточка "Аист"
  - Карточка "Синица"
  - Карточка "Ястреб"
- Сет "Рыбы"
  - Карточка "Окунь"
  - Карточка "Щука"
  - Карточка "Марлин"

Сервис должен уметь "давать" пользователю определенную карточку.

В процессе начисления в системе должны генерироваться следующие события:
- Пользователь закончил сет
- Пользователь закончил альбома

Запросы на довабление могут вызываться в многопоточной среде. Состояние пользователей можем хранить в памяти.
В качестве теста системы можно использовать следующий сценарий использования:
- Случайно генерируем карточки определенному набору пользователей из n потоков до тех пор, пока все они не закончат альбом.